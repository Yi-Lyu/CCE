# Claude 智能代理服务配置
# 请复制此文件为 config.local.yaml 并填入您的真实 API 信息

proxy:
  port: 27015              # 代理监听端口
  read_timeout: 1800       # HTTP读取超时（秒）- 30分钟
  write_timeout: 1800      # HTTP写入超时（秒）- 30分钟
  idle_timeout: 300        # 连接空闲超时（秒）- 5分钟
  request_timeout: 1800    # 请求转发超时（秒）- 30分钟
  evaluator_timeout: 30    # 评估服务超时（秒）- 30秒

# 服务列表（仅包含3个服务的示例配置）
services:
  # 决策者服务 - 必须有至少一个 role 为 "evaluator" 的服务
  - id: "evaluator-main"
    name: "主决策者服务"
    url: "https://api.example.com/v1/messages"  # 替换为您的决策者服务地址
    api_key: "your-evaluator-api-key-here"      # 替换为您的 API Key
    role: "evaluator"
    supports_thinking: true  # 根据您的服务是否支持thinking模式设置

  # 执行者服务1 - 用于简单任务
  - id: "easy-executor"
    name: "Easy Executor（简单任务处理）"
    url: "https://api.example.com/v1/messages"  # 替换为您的服务地址
    api_key: "your-easy-api-key-here"           # 替换为您的 API Key
    role: "executor"
    supports_thinking: true  # 根据您的服务是否支持thinking模式设置

  # 执行者服务2 - 用于复杂任务
  - id: "harder-executor"
    name: "Harder Executor（复杂任务处理）"
    url: "https://api.example.com/v1/messages"  # 替换为您的服务地址
    api_key: "your-harder-api-key-here"         # 替换为您的 API Key
    role: "executor"
    supports_thinking: true  # 根据您的服务是否支持thinking模式设置

# 难度等级映射 (1-5)
difficulty_mapping:
  "1": "easy-executor"    # 最简单的任务
  "2": "easy-executor"    # 简单任务
  "3": "easy-executor"    # 中等任务
  "4": "harder-executor"  # 复杂任务
  "5": "harder-executor"  # 最复杂的任务

# 决策者配置
evaluator:
  model: "claude-3-haiku-20240307"
  max_tokens: 100
  include_history: true
  max_history_rounds: 3
  prompt_template: |
    你是一个任务复杂度评估专家。请分析以下 Claude API 请求中【当前这一步具体任务】的复杂度，并返回 JSON 格式的结果。

    重要说明：
    - 请评估【当前这一步操作】的复杂度，而非整体项目的复杂度
    - 请聚焦于当前需要执行的具体操作，不要被项目整体规模影响判断

    当前任务信息：
    - 模型: {{.Model}}
    - 消息数量: {{.MessageCount}}
    - 当前任务: {{.CurrentTask}}{{.HistoryContext}}

    评估标准：
    1 级（非常简单）：简单查询、基础问答、单行代码、创建简单文件
    2 级（简单）：基础分析、简单总结、格式转换、修改配置
    3 级（中等）：代码编写、数据分析、模块开发、多文件修改
    4 级（复杂）：架构设计、复杂重构、多模块集成、算法实现
    5 级（非常复杂）：系统设计、多步骤规划任务、大型重构

    请严格按照以下 JSON 格式返回：
    {
      "difficulty_level": 数字（必须是1-5之间的整数）
    }

    你的评估：

# 功能开关
features:
  evaluator_fallback: true   # 决策者服务不可用时使用备选
  service_auto_switch: false # 目标服务不可用时自动切换
  request_logging: true      # 启用请求日志

# 日志配置
logging:
  level: "info"              # 日志级别：debug, info, warn, error
  output_path: "./logs"      # 日志文件保存路径